<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.26">
    <meta name="theme-color" content="#4770eb"><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>Migrating from v1 to v2 | dataclass</title><meta name="description" content="">
    <link rel="modulepreload" href="/assets/app.260f48b5.js"><link rel="modulepreload" href="/assets/migrating.html.dd65b5d3.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.5a098b48.js"><link rel="modulepreload" href="/assets/migrating.html.07aa8ea5.js">
    <link rel="stylesheet" href="/assets/style.b9ce4a10.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">dataclass</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/guide/" class="nav-link router-link-active" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/reference/" class="nav-link" aria-label="Reference"><!--[--><!--]--> Reference <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/alexeyraspopov/dataclass" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/guide/" class="nav-link router-link-active" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/reference/" class="nav-link" aria-label="Reference"><!--[--><!--]--> Reference <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/alexeyraspopov/dataclass" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item active">Guide</p><ul class=""><li><!--[--><a href="/guide/" class="nav-link router-link-active sidebar-item" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/guide/installation.html" class="nav-link sidebar-item" aria-label="Installation"><!--[--><!--]--> Installation <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/guide/getting-started.html" class="nav-link sidebar-item" aria-label="Getting Started"><!--[--><!--]--> Getting Started <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/guide/objects-equality.html" class="nav-link sidebar-item" aria-label="Objects Equality"><!--[--><!--]--> Objects Equality <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/guide/serialization-deserialization.html" class="nav-link sidebar-item" aria-label="Serialization &amp; Deserialization"><!--[--><!--]--> Serialization &amp; Deserialization <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/guide/migrating.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="Migrating from v1 to v2"><!--[--><!--]--> Migrating from v1 to v2 <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/guide/migrating.html#the-class-name-and-import-type-has-been-changed" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="The class name and import type has been changed"><!--[--><!--]--> The class name and import type has been changed <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/guide/migrating.html#drop-typescript-generic-from-class-definitions" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Drop TypeScript generic from class definitions"><!--[--><!--]--> Drop TypeScript generic from class definitions <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/guide/migrating.html#use-static-method-create-instead-of-new-operator" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Use static method create() instead of new operator"><!--[--><!--]--> Use static method create() instead of new operator <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/guide/migrating.html#ensure-no-mutations-happening-in-the-code" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Ensure no mutations happening in the code"><!--[--><!--]--> Ensure no mutations happening in the code <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/guide/migrating.html#make-sure-the-dependency-is-transpiled-if-necessary" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Make sure the dependency is transpiled, if necessary"><!--[--><!--]--> Make sure the dependency is transpiled, if necessary <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a href="/guide/contributing.html" class="nav-link sidebar-item" aria-label="Contributing"><!--[--><!--]--> Contributing <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="migrating-from-v1-to-v2" tabindex="-1"><a class="header-anchor" href="#migrating-from-v1-to-v2" aria-hidden="true">#</a> Migrating from v1 to v2</h1><h2 id="the-class-name-and-import-type-has-been-changed" tabindex="-1"><a class="header-anchor" href="#the-class-name-and-import-type-has-been-changed" aria-hidden="true">#</a> The class name and import type has been changed</h2><p>The library was created in 2017, long ago before <a href="https://github.com/tc39/proposal-record-tuple" target="_blank" rel="noopener noreferrer">Records &amp; Tuples proposal<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> was created. The fact this proposal is moving towards being a part of the language means &quot;Record&quot; as a term gains very particular meaning for the ecosystem. Besides, <a href="https://immutable-js.com/docs/v4.0.0/Record/" target="_blank" rel="noopener noreferrer"><code>Immutable.Record</code><span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> and <a href="https://www.typescriptlang.org/docs/handbook/utility-types.html#recordkeys-type" target="_blank" rel="noopener noreferrer">TypeScript&#39;s Record<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> could potentially create confusion as well. Thus, the abstract class <code>Record</code> has been renamed to <code>Data</code>.</p><p>Dataclass v1 exposed a single default export which seemed to work just fine for most of the cases. However, it can create additional burden for CommonJS code and require some unnecessary tricks from the bundlers. Thus, Dataclass v2 uses named export.</p><div class="language-diff ext-diff"><pre class="language-diff"><code><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">import Record from &quot;dataclass&quot;;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import { Data } from &quot;dataclass&quot;;
</span></span></code></pre></div><h2 id="drop-typescript-generic-from-class-definitions" tabindex="-1"><a class="header-anchor" href="#drop-typescript-generic-from-class-definitions" aria-hidden="true">#</a> Drop TypeScript generic from class definitions</h2><p>Dataclass v1 required TypeScript classes to be generic due to <a href="https://github.com/Microsoft/TypeScript/issues/5863" target="_blank" rel="noopener noreferrer">polymorphic <code>this</code> for static members issue<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>. The issue has not been resolved but in Dataclass v2 there was a change in typings that helped avoiding the issue in the first place. Now, the user&#39;s classes don&#39;t need to be generic.</p><div class="language-diff ext-diff"><pre class="language-diff"><code><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">class User extends Record&lt;User&gt; {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">class User extends Data {
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: string = &quot;Anon&quot;;
</span></span>}
</code></pre></div><h2 id="use-static-method-create-instead-of-new-operator" tabindex="-1"><a class="header-anchor" href="#use-static-method-create-instead-of-new-operator" aria-hidden="true">#</a> Use static method <code>create()</code> instead of <code>new</code> operator</h2><p>Dataclass v2 uses new implementation for class instantiation due to some browser incompatibilities.</p><div class="language-diff ext-diff"><pre class="language-diff"><code><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">let user = new User({ name: &quot;Ann&quot; });
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">let user = User.create({ name: &quot;Ann&quot; });
</span></span></code></pre></div><p>Moving to dataclass v2 will make use of <code>new</code> operator throwing runtime errors, suggesting to use static <code>create()</code> method instead.</p><h2 id="ensure-no-mutations-happening-in-the-code" tabindex="-1"><a class="header-anchor" href="#ensure-no-mutations-happening-in-the-code" aria-hidden="true">#</a> Ensure no mutations happening in the code</h2><p>While instance of data classes treated as immutable, the implementation still uses some safety precautions to ensure no mutations (accidental or intentional) can be made. In v1, when a prop is mutated, nothing happens, the value remains the same. The operation is basically ignored.</p><div class="language-typescript ext-ts"><pre class="language-typescript"><code><span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

user<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// &gt; 18</span>
</code></pre><div class="highlight-lines"><br><br><div class="highlight-line"> </div><br><br><br></div></div><p>In v2, however, some additional precautions were made, to ensure that developers can spot bad code and mistakes. Mutating a property will now throw an error:</p><div class="language-typescript ext-ts"><pre class="language-typescript"><code><span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

user<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token comment">// Uncaught TypeError: &quot;age&quot; is read-only</span>
</code></pre><div class="highlight-lines"><br><br><div class="highlight-line"> </div><br></div></div><p>This error comes from the use of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze" target="_blank" rel="noopener noreferrer"><code>Object.freeze()</code><span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> which throws an error when there was an attempt to mutate an existing property and when the user tries to add new property to the object.</p><h2 id="make-sure-the-dependency-is-transpiled-if-necessary" tabindex="-1"><a class="header-anchor" href="#make-sure-the-dependency-is-transpiled-if-necessary" aria-hidden="true">#</a> Make sure the dependency is transpiled, if necessary</h2><p>See <a href="/guide/installation.html#troubleshooting" class="">Installation Guide &amp; Troubleshooting</a> for more details.</p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/alexeyraspopov/dataclass/edit/master/docs/guide/migrating.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">10/12/2021, 11:48:48 PM</span></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: alexey.raspopov@datarobot.com">Alexey Raspopov</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/guide/serialization-deserialization.html" class="nav-link" aria-label="Serialization &amp; Deserialization"><!--[--><!--]--> Serialization &amp; Deserialization <!--[--><!--]--></a></span><span class="next"><a href="/guide/contributing.html" class="nav-link" aria-label="Contributing"><!--[--><!--]--> Contributing <!--[--><!--]--></a> → </span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.260f48b5.js" defer></script>
  </body>
</html>
